<html>

	<head>

		<style>

			body, html
			{
				margin: 0;
				padding: 0;
			}
			#webview
			{
				display:inline-flex; 
				height:100%; 
				width:100%;
			}

		</style>

	</head>

	<script>

		function getget(parameterName) 
		{
			var result = null,
				tmp = [];
			location.search
				.substr(1)
				.split("&")
				.forEach(function (item) {
				  tmp = item.split("=");
				  if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
				});
			return result;
		}		

		onload = () => 
		{	
			const electron = require('electron')
			const remote = electron.remote
			const path = require('path')
			const BrowserWindow = remote.BrowserWindow
			const webview = document.querySelector('#webview')

			webview.src = getget("url")

			webview.focus()

			webview.addEventListener('new-window', (e) => 
			{
				if(e.url.startsWith("https://hue.merkoba.com"))
				{
					const win = new BrowserWindow({width: 800, height: 600, frame:false, icon:path.join(__dirname, 'logo.png'), show:false})

					win.once('ready-to-show', () => win.show())

					win.maximize()

					win.loadURL("file://" + path.join(__dirname, "main.html") + `?url=${e.url}`)

					win.on('closed', () => 
					{
						win = null
					})	

					event.newGuest = win
				}

				else
				{
					electron.shell.openExternal(e.url)
				}
			})

			webview.addEventListener('page-title-updated', (e) => 
			{
				remote.getCurrentWindow().setTitle(e.title)
			})

			remote.getCurrentWindow().on('focus', (e) =>
			{
				webview.focus()
			})
		}

	</script>

	<body>
		<webview id="webview"></webview>
	</body>

</html>